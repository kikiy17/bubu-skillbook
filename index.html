<!doctype html>
<html lang="zh-Hant"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>è·æ¥­æŠ€èƒ½æ‰‹å†Š</title>
<style>
body{font-family:ui-sans-serif,system-ui,"Noto Sans TC","PingFang TC";background:#0b1020;color:#eef3ff;margin:0}
header{position:sticky;top:0;background:#0f1730;border-bottom:1px solid #1d2a52;padding:12px}
.wrap{max-width:1080px;margin:0 auto;padding:0 12px}
.controls{display:grid;grid-template-columns:1.2fr 1fr 1fr 1fr 1fr;gap:8px}
input,select{padding:8px 10px;background:#0b1630;color:#e6ecff;border:1px solid #223158;border-radius:8px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px;padding:16px 0 40px}
.card{background:#111a36;border:1px solid #23305a;border-radius:14px;padding:12px}
.pill{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid #2f467a;background:#0d1630;color:#9fc5ff}
.meta{opacity:.7;font-size:12px}
</style></head>
<body>
<header><div class="wrap">
  <h1>è·æ¥­æŠ€èƒ½æ‰‹å†Š</h1>
  <div class="controls">
    <input id="q" placeholder="ğŸ” æœå°‹ï¼šæŠ€èƒ½ / è·æ¥­ / ID"/>
    <select id="job"><option value="">è·æ¥­ï¼ˆå…¨éƒ¨ï¼‰</option></select>
    <select id="type"><option value="">é¡å‹ï¼ˆå…¨éƒ¨ï¼‰</option><option value="active">ä¸»å‹•</option><option value="passive">è¢«å‹•</option></select>
    <select id="target"><option value="">ç›®æ¨™ï¼ˆå…¨éƒ¨ï¼‰</option><option value="enemy">æ•µæ–¹</option><option value="self">è‡ªèº«</option><option value="team">æˆ‘æ–¹å…¨é«”</option><option value="allyTeam">æˆ‘æ–¹å…¨é«”(allyTeam)</option></select>
    <select id="tier"><option value="">è½‰è·éšå±¤ï¼ˆå…¨éƒ¨ï¼‰</option><option value="1">ä¸€è½‰</option><option value="2">äºŒè½‰</option><option value="3">ä¸‰è½‰</option></select>
  </div>
  <div class="meta" id="meta"></div>
</div></header>
<main><div class="wrap"><div id="grid" class="grid"></div></div></main>
<script>
let ALL=[], FILTERED=[];
fetch('./skills.json').then(r=>r.json()).then(({meta, skills})=>{
  ALL = skills;
  document.getElementById('meta').textContent = 'å…± ' + skills.length + ' æŠ€èƒ½ï½œæ›´æ–°ï¼š' + new Date(meta.lastUpdated).toLocaleString();
  buildJobOptions(skills); apply();
});
function buildJobOptions(skills){
  const set = new Set(skills.map(s=>s.jobName).filter(Boolean));
  const sel = document.getElementById('job');
  [...set].sort((a,b)=>a.localeCompare(b,'zh-Hant')).forEach(j=>{
    const o = document.createElement('option'); o.value=j; o.textContent=j; sel.appendChild(o);
  });
}
function mapTarget(t){ return ({enemy:'æ•µæ–¹', self:'è‡ªèº«', team:'æˆ‘æ–¹å…¨é«”', allyTeam:'æˆ‘æ–¹å…¨é«”(allyTeam)'})[t] || t || 'â€”'; }
function fmtScaling(sc){const ks=Object.keys(sc||{});return ks.length?ks.map(k=>k+'Ã—'+sc[k]).join('ã€'):'â€”'}
function pct(n){return Math.round((Number(n||0))*100)+'%'}
function fmtEffects(e){
  if(!e||!Object.keys(e).length) return 'â€”';
  const out=[];
  if(e.stun) out.push('æšˆçœ© '+e.stun.duration+'s');
  if(e.mark) out.push('æ¨™è¨˜ å—å‚·+'+pct(e.mark.damageTakenUp)+' æŒçºŒ'+(e.mark.duration||'-')+'s');
  if(e.teamDamageReduce) out.push('éšŠä¼æ¸›å‚· '+pct(e.teamDamageReduce.amount)+' æŒçºŒ'+e.teamDamageReduce.duration+'s');
  if(e.selfBuff?.damageReduce) out.push('è‡ªæˆ‘æ¸›å‚· '+pct(e.selfBuff.damageReduce.amount)+' æŒçºŒ'+e.selfBuff.damageReduce.duration+'s');
  if(e.defensePierce) out.push('ç©¿é€ +'+pct(e.defensePierce));
  if(e.followUpChance) out.push('è¿½æ“Šæ©Ÿç‡ +'+pct(e.followUpChance));
  if(e.followUpMultiplier) out.push('è¿½æ“Šå€ç‡ '+pct(e.followUpMultiplier));
  if(e.forceCrit) out.push('å¿…çˆ†');
  if(e.trueDamage?.ratio) out.push('çœŸå¯¦å‚·å®³ '+pct(e.trueDamage.ratio));
  if(e.lowHpDamageUp) out.push('æ–¬æ®ºé–¾å€¼ '+pct(e.lowHpDamageUp.threshold)+'ï¼ŒåŠ æˆ '+pct(e.lowHpDamageUp.bonus));
  if(e.critRateBonus) out.push('çˆ†æ“Šç‡ +'+pct(e.critRateBonus));
  if(e.damageUp) out.push('å¢å‚· +'+pct(e.damageUp));
  if(e.healUp) out.push('å—ç™‚ +'+pct(e.healUp));
  return out.join(' / ');
}
function fmtStars(ss){ return (ss||[]).map(x=>'â˜…'+x.star+'Ã—'+x.multiplier).join(' ï¼Œ ') || 'â€”'; }
function card(s){
  return `<div class="card">
    <div style="display:flex;justify-content:space-between;align-items:baseline;gap:8px">
      <h3 style="margin:0">${s.name}</h3><span class="pill">Tier ${s.tier}</span>
    </div>
    <div style="opacity:.95;margin:6px 0 10px">${s.description||''}</div>
    <div style="font-size:12px;display:flex;flex-wrap:wrap;gap:8px;margin-bottom:8px">
      <span>è·æ¥­ï¼š${s.jobName||'â€”'}</span><span>é¡å‹ï¼š${s.type}</span><span>ç›®æ¨™ï¼š${mapTarget(s.target)}</span><span>å†·å»ï¼š${s.cooldownSec??'-'}s</span><span>IDï¼š${s.id}</span>
    </div>
    <details><summary>æ•¸æ“š / å‡æ˜Ÿ</summary>
      <div>å€ç‡ï¼š${fmtScaling(s.scaling)}</div>
      <div>æ•ˆæœï¼š${fmtEffects(s.effects)}</div>
      <div style="margin-top:6px">æ˜Ÿç­‰ä¹˜æ•¸ï¼š${fmtStars(s.starSpread)}</div>
    </details>
  </div>`;
}
function apply(){
  const q = (document.getElementById('q').value||'').toLowerCase();
  const job = document.getElementById('job').value;
  const type = document.getElementById('type').value;
  const target = document.getElementById('target').value;
  const tier = document.getElementById('tier').value;

  FILTERED = ALL.filter(s=>{
    if (q) {
      const hay = (s.name+' '+s.id+' '+(s.jobName||'')+' '+(s.description||'')).toLowerCase();
      if (!hay.includes(q)) return false;
    }
    if (job && s.jobName !== job) return false;
    if (type && s.type !== type) return false;
    if (target && s.target !== target) return false;
    if (tier && String(s.tier) !== tier) return false;
    return true;
  });

  document.getElementById('grid').innerHTML = FILTERED.map(card).join('');
}
['q','job','type','target','tier'].forEach(id=>{
  const el = document.getElementById(id);
  if (el) { el.addEventListener('input', apply); el.addEventListener('change', apply); }
});
</script>
</body></html>